/*! outsider 2017-05-30 */
angular.module("authService",[]).factory("Auth",["$http","$q","Token","$localStorage",function($http,$q,Token,$localStorage){var auth={};return auth.login=function(email,password){return $http.post("api/auth",{email:email,password:password}).success(function(data){return Token.set(data.token),data})},auth.logout=function(){console.log("Hey"),Token.set()},auth.isLoggedIn=function(){return!!Token.get()},auth.pullUser=function(){return Token.get()?(console.log("Getting"),$http.get("/api/me")):$q.reject({message:"No token found"})},auth.setUser=function(data){data?$localStorage.user=data:$localStorage.user=void 0},auth.getUser=function(data){return $localStorage.user},auth.hasRole=function(r){return!!$localStorage.user.role&&$localStorage.user.role.indexOf(r)>-1},auth}]).factory("Token",["$window",function($window){var token={};return token.get=function(){return $window.localStorage.getItem("token")},token.set=function(token){token?$window.localStorage.setItem("token",token):$window.localStorage.removeItem("token",token)},token}]).factory("Interceptor",["$q","$location","Token",function($q,$location,Token){var interceptor={};return interceptor.request=function(config){var token=Token.get();return token&&(config.headers["x-access-token"]=token),config},interceptor.response=function(response){return response.data.falseStatus&&$location.path("/"+response.data.falseStatus),response},interceptor.responseError=function(response){switch(console.log(response),response.falseStatus){case 401:Token.set(),Auth.setUser(),$location.path("/401");break;case 403:$location.path("/403");break;case 404:$location.path("/404");break;default:$location.path("/500")}return $q.reject(response)},interceptor}]);